<!DOCTYPE html>
<html>

<%- include('partials/head', {
  pageTitle: 'Choose a Deck - MTG Deck Shuffler',
  fontFamily: 'Ovo'
}) %>

<body>
  <div class="deck-selection-page">
    <%- include('partials/header', { activePage: 'play' }) %>

    <section class="hero">
      <h2 class="step-action">Choose</h2>
      <p class="step-object">any deck</p>
    </section>

    <div id="homepage-content" class="page-with-title-container">
      <h1 class="page-title">Choose a Deck to Play</h1>
      <div id="deck-inputs">
        <% if (availableDecks && availableDecks.length > 0) { %>
          <% const localDecks = availableDecks.filter(deck => deck.deckSource === 'local'); %>
          <% if (localDecks.length > 0) { %>
            <form method="POST" action="/deck" class="deck-input-section">
              <label for="local-deck" class="deck-label">Choose a preconstructed deck to play</label>
              <input type="hidden" name="deck-source" value="local" />
              <select id="local-deck" name="local-deck">
                <% localDecks.forEach(function(deck) { %>
                  <option value="<%= deck.localFile %>"><%= deck.description %></option>
                <% }); %>
              </select>
              <button type="submit" class="lets-play-button">Play</button>
            </form>
          <% } %>
        <% } %>

        <form class="deck-input-section" method="POST" action="/deck">
          <label for="deck-number" class="deck-label">Or play any deck on <a href="https://archidekt.com/" target="_blank">Archidekt</a></label>
          <input type="text" id="deck-number" name="deck-number" placeholder="deck number" />
          <input type="hidden" name="deck-source" value="archidekt" />
          <button type="submit" id="load-deck-button" class="lets-play-button" disabled>Load Deck</button>
        </form>
      </div>

      <div id="modal-container"></div>

      <div class="slogan">
        <h1>Play any deck, anywhere, with your favorite people!</h1>
      </div>
    </div>

    <%- include('partials/footer') %>
  </div>

  <script src="/htmx.js"></script>
  <script>
    // Enable/disable the Load Deck button based on input
    const deckNumberInput = document.getElementById('deck-number');
    const loadDeckButton = document.getElementById('load-deck-button');

    if (deckNumberInput && loadDeckButton) {
      deckNumberInput.addEventListener('input', function() {
        loadDeckButton.disabled = !this.value.trim();
      });
    }
  </script>
</body>

</html>
